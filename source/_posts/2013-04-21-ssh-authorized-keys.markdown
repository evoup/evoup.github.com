---
layout: post
title: "创建ssh信任失败的原因分析和改进"
date: 2013-04-21 18:15
comments: true
categories: shell 
---

今天在给一台服务器做信任的时候出现了完成之后登录会提示输入密码。经过起初的ssh-copy-id和手工拷贝公钥到对方服务器的authorized_keys文件中，到后来的再次ssh-keygen反复试错无果之后，最终把问题锁定在了权限。

除了authorized_keys文件给予644或者600权限，.ssh文件夹给予755权限，此外用户目录的权限也必须是755或711，最终修改用户文件夹权限完成免密码登录。

由此推断：

一，管理员在开帐号的时候采用的错误的脚本。

二，ssh-copy-id这个工具可以改进。

目前简单的方式就是直接把目录权限做成711或者755。
