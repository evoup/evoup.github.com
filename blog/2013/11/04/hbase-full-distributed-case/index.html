
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>HBASE完全分布式搭建(VMware版) - Evoup`s Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="接上一篇《HADOOP完全分布式搭建(VMware版)》 参考 http://www.cnblogs.com/flyoung2008/archive/2011/12/02/2272761.html 1
2
3
4
cd /u01/app
tar xzf hbase-0.90.6.tgz
ln -s &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://evoupsight.com/blog/2013/11/04/hbase-full-distributed-case">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Evoup`s Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Evoup`s Blog</a></h1>
  
    <h2>Life is an endless fighting</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:evoupsight.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">HBASE完全分布式搭建(VMware版)</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-04T16:28:00+08:00" pubdate data-updated="true">Nov 4<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>接上一篇<a href="http://evoupsight.com/blog/2013/11/04/hadoop-full-distributed-case/">《HADOOP完全分布式搭建(VMware版)》</a></p>

<p>参考 <a href="http://www.cnblogs.com/flyoung2008/archive/2011/12/02/2272761.html">http://www.cnblogs.com/flyoung2008/archive/2011/12/02/2272761.html</a></p>

<!-- more -->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> /u01/app
</span><span class='line'>tar xzf hbase-0.90.6.tgz
</span><span class='line'>ln -s hbase-0.90.6 hbase
</span><span class='line'><span class="nb">cd </span>hbase/conf
</span></code></pre></td></tr></table></div></figure>


<p>编辑hbase-env.sh</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">export </span><span class="nv">HBASE_OPTS</span><span class="o">=</span><span class="s2">&quot;-ea -XX:+UseConcMarkSweepGC -XX:+CMSIncrementalMode&quot;</span>
</span><span class='line'><span class="nb">export </span><span class="nv">JAVA_HOME</span><span class="o">=</span>/usr/java/jdk1.6.0_29
</span><span class='line'><span class="nb">export </span><span class="nv">HBASE_MANAGES_ZK</span><span class="o">=</span><span class="nb">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>注意HADOOP_HOME和HBASE_HOME已经在~/.profile中指定，不需要再设置了。</p>

<p>编辑hbase-site.xml</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
</span><span class='line'><span class="cp">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span>
</span><span class='line'><span class="c">&lt;!--</span>
</span><span class='line'><span class="c">/**</span>
</span><span class='line'><span class="c"> * Copyright 2010 The Apache Software Foundation</span>
</span><span class='line'><span class="c"> *</span>
</span><span class='line'><span class="c"> * Licensed to the Apache Software Foundation (ASF) under one</span>
</span><span class='line'><span class="c"> * or more contributor license agreements.  See the NOTICE file</span>
</span><span class='line'><span class="c"> * distributed with this work for additional information</span>
</span><span class='line'><span class="c"> * regarding copyright ownership.  The ASF licenses this file</span>
</span><span class='line'><span class="c"> * to you under the Apache License, Version 2.0 (the</span>
</span><span class='line'><span class="c"> * &quot;License&quot;); you may not use this file except in compliance</span>
</span><span class='line'><span class="c"> * with the License.  You may obtain a copy of the License at</span>
</span><span class='line'><span class="c"> *</span>
</span><span class='line'><span class="c"> *     http://www.apache.org/licenses/LICENSE-2.0</span>
</span><span class='line'><span class="c"> *</span>
</span><span class='line'><span class="c"> * Unless required by applicable law or agreed to in writing, software</span>
</span><span class='line'><span class="c"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
</span><span class='line'><span class="c"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span><span class='line'><span class="c"> * See the License for the specific language governing permissions and</span>
</span><span class='line'><span class="c"> * limitations under the License.</span>
</span><span class='line'><span class="c"> */</span>
</span><span class='line'><span class="c">--&gt;</span>
</span><span class='line'><span class="nt">&lt;configuration&gt;</span>
</span><span class='line'>    <span class="nt">&lt;property&gt;</span>
</span><span class='line'>        <span class="nt">&lt;name&gt;</span>hbase.rootdir<span class="nt">&lt;/name&gt;</span>
</span><span class='line'>        <span class="nt">&lt;value&gt;</span>hdfs://mdn2.net:9024/hbase<span class="nt">&lt;/value&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/property&gt;</span>
</span><span class='line'>    <span class="nt">&lt;property&gt;</span>
</span><span class='line'>        <span class="nt">&lt;name&gt;</span>hbase.cluster.distributed<span class="nt">&lt;/name&gt;</span>
</span><span class='line'>        <span class="nt">&lt;value&gt;</span>true<span class="nt">&lt;/value&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/property&gt;</span>
</span><span class='line'>    <span class="nt">&lt;property&gt;</span>
</span><span class='line'>        <span class="nt">&lt;name&gt;</span>hbase.master<span class="nt">&lt;/name&gt;</span>
</span><span class='line'>        <span class="nt">&lt;value&gt;</span>mdn2.net:60000<span class="nt">&lt;/value&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/property&gt;</span>
</span><span class='line'>    <span class="nt">&lt;property&gt;</span>
</span><span class='line'>        <span class="nt">&lt;name&gt;</span>hbase.zookeeper.quorum<span class="nt">&lt;/name&gt;</span>
</span><span class='line'>        <span class="nt">&lt;value&gt;</span>mdn2.net,mdn2_datanode1.net,mdn2_datanode2.net<span class="nt">&lt;/value&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/property&gt;</span>
</span><span class='line'><span class="nt">&lt;/configuration&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>注意点：
 1.其中首先需要注意hdfs://mdn2.net:9024/hbase这里，必须与你的Hadoop集群的core-site.xml文件配置保持完全一致才行，如果你Hadoop的hdfs使用了其它端口，请在这里也修改。再者就是Hbase该项并不识别机器IP，只能使用机器hostname才可行，即若使用IP是会抛出java错误。
 2.hbase.zookeeper.quorum 的个数必须是奇数。</p>

<p>修改regionservers文件（同hadoop的slaves文件）</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mdn2_datanode1.net
</span><span class='line'>mdn2_datanode2.net
</span></code></pre></td></tr></table></div></figure>


<p>然后分发到各点，就可以启动了。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bin/start hbase
</span><span class='line'>bin/hbase shell
</span></code></pre></td></tr></table></div></figure>


<p>报错
ERROR: org.apache.hadoop.hbase.ZooKeeperConnectionException: HBase is able to connect to ZooKeeper but the connection closes immediately. This could be a sign that the server has too many connections (30 is the default). Consider inspecting your ZK server logs for that error and then make sure you are reusing HBaseConfiguration as often as you can. See HTable&rsquo;s javadoc for more information.
看来不要使用hbase托管的zookeeper转而再装一个试试。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>wget http://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.4.4/zookeeper-3.4.4.tar.gz
</span></code></pre></td></tr></table></div></figure>


<p>编辑~/.profile,加入关于zk环境变量的设置</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">export </span><span class="nv">ZOOKEEPER_HOME</span><span class="o">=</span><span class="s2">&quot;/u01/app/zookeeper/&quot;</span>
</span><span class='line'><span class="nv">PATH</span><span class="o">=</span><span class="nv">$ZOOKEEPER_HOME</span>/bin:<span class="nv">$PATH</span>
</span><span class='line'><span class="nb">export </span>PATH
</span><span class='line'><span class="nb">cd</span> /u01/app/zookeeper/conf
</span><span class='line'>cp zoo_sample.cfg zoo.cfg
</span><span class='line'><span class="nb">cd</span> ../bin
</span><span class='line'>./zkServer.sh start
</span></code></pre></td></tr></table></div></figure>


<p>最后重启整个hadoop/hbase搞定，jps看下跑的进程。收工。</p>

<p><img src="/images/evoup/hbase_vmware.png" alt="Alt text" /></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Your Name</span></span>

      








  


<time datetime="2013-11-04T16:28:00+08:00" pubdate data-updated="true">Nov 4<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/hadoop/'>hadoop</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://evoupsight.com/blog/2013/11/04/hbase-full-distributed-case/" data-via="" data-counturl="http://evoupsight.com/blog/2013/11/04/hbase-full-distributed-case/" >Tweet</a>
  
  
  
  
  <div class="bshare-custom"><a title="分享到QQ空间" class="bshare-qzone"></a><a title="分享到新浪微博" class="bshare-sinaminiblog"></a><a title="分享到人人网" class="bshare-renren"></a><a title="分享到腾讯微博" class="bshare-qqmb"></a><a title="分享到网易微博" class="bshare-neteasemb"></a><a title="更多平台" class="bshare-more bshare-more-icon more-style-addthis"></a><span class="BSHARE_COUNT bshare-share-count">0</span></div><script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/buttonLite.js#style=-1&amp;uuid=&amp;pophcol=2&amp;lang=zh"></script><script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/bshareC0.js"></script>
<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js"></script>
<!-- UY END -->
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/11/04/hadoop-full-distributed-case/" title="Previous Post: HADOOP完全分布式搭建(VMware版)">&laquo; HADOOP完全分布式搭建(VMware版)</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/11/05/freebsd-install-vmware-tool/" title="Next Post: freebsd下安装vmware-tool">freebsd下安装vmware-tool &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/12/gvim-unreadable-codes/">解决gvim菜单乱码问题</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/08/centos-install-cvs/">centos下CVS服务器的配置</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/07/erlang-rebar-notool-not-found/">Rebar生成发布包后找不到noodtool</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/05/erl-crash-webtool-usage/">使用webtool查看erl_crash.dump</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/05/freebsd-install-vmware-tool/">Freebsd下安装vmware-tool</a>
      </li>
    
  </ul>
</section>


<section>
<h1>分类</h1>
<span class='categories_tag'> <a href='/blog/categories/c-language' style='font-size: 134.28571428571428%'>C-language(8)</a>  <a href='/blog/categories/cplusplus' style='font-size: 117.14285714285714%'>Cplusplus(4)</a>  <a href='/blog/categories/erlang' style='font-size: 160.0%'>Erlang(14)</a>  <a href='/blog/categories/freebsd' style='font-size: 108.57142857142857%'>Freebsd(2)</a>  <a href='/blog/categories/gcc' style='font-size: 104.28571428571429%'>Gcc(1)</a>  <a href='/blog/categories/hadoop' style='font-size: 108.57142857142857%'>Hadoop(2)</a>  <a href='/blog/categories/haproxy' style='font-size: 104.28571428571429%'>Haproxy(1)</a>  <a href='/blog/categories/hbase' style='font-size: 104.28571428571429%'>Hbase(1)</a>  <a href='/blog/categories/java' style='font-size: 108.57142857142857%'>Java(2)</a>  <a href='/blog/categories/javascript' style='font-size: 112.85714285714286%'>Javascript(3)</a>  <a href='/blog/categories/mongodb' style='font-size: 104.28571428571429%'>Mongodb(1)</a>  <a href='/blog/categories/monitor' style='font-size: 117.14285714285714%'>Monitor(4)</a>  <a href='/blog/categories/nginx' style='font-size: 112.85714285714286%'>Nginx(3)</a>  <a href='/blog/categories/octopress' style='font-size: 104.28571428571429%'>Octopress(1)</a>  <a href='/blog/categories/php' style='font-size: 112.85714285714286%'>Php(3)</a>  <a href='/blog/categories/python' style='font-size: 104.28571428571429%'>Python(1)</a>  <a href='/blog/categories/rrdtool' style='font-size: 117.14285714285714%'>Rrdtool(4)</a>  <a href='/blog/categories/shell' style='font-size: 108.57142857142857%'>Shell(2)</a>  <a href='/blog/categories/version-control' style='font-size: 104.28571428571429%'>Version_control(1)</a>  <a href='/blog/categories/vim' style='font-size: 117.14285714285714%'>Vim(4)</a> </span>
</section>

<section>
    <h1>新浪微博</h1>
    <ul id="weibo">
    <li>
    <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=2839412552&verifier=2533dcd4&dpc=1"></iframe>
    </li>
    </ul>
</section><section>
    <h1>友情链接</h1>
    <ul>
        <li>
            <a href="http://www.konanblog.info" target=_BLANK>Konan`s blog</a>
        </li>
    </ul>
</section><section>
<h1>My Douban</h1>
<div>
<script type="text/javascript" src="http://www.douban.com/service/badge/evoupYin/?show=wishlist&n=9&columns=3&hidelogo=yes&cat=movie|book" ></script>
</div>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
